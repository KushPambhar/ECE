<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ECE Weekly Timetable ‚Äî Interactive</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
body{font-family:Inter,system-ui,sans-serif}
.timetable-cell-content{display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;min-height:70px}
.subject{font-weight:600;font-size:.9rem;color:#111827}
.location{font-size:.8rem;color:#6B7280}
.current-slot{background:#FBBF24!important;color:#111;box-shadow:0 0 15px rgba(0,0,0,.12);transform:scale(1.02)}
.current-slot .location{color:#374151}
</style>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body class="bg-gray-50 text-gray-800 antialiased">

<div class="container mx-auto p-4 sm:p-6 lg:p-8">

<header class="text-center mb-8">
<h1 class="text-3xl sm:text-4xl font-bold">ECE Weekly Timetable</h1>
<p class="mt-2 text-gray-600">
UG ‚Äî Semester IV ‚Ä¢ Section-wise Interactive Timetable
</p>
</header>

<div class="flex flex-col sm:flex-row gap-4 justify-center items-center mb-6">
  <div class="flex items-center gap-2">
    <label class="font-medium">Select Section:</label>
    <select id="ece-selector"
      class="border rounded-md px-3 py-2 focus:ring-indigo-500">
      <option value="ece1">ECE 1</option>
      <option value="ece2" selected>ECE 2</option>
      <option value="ece3">ECE 3</option>
      <option value="ece4">ECE 4</option>
      <option value="ece5">ECE 5</option>
    </select>
  </div>

  <button id="highlight-now-btn"
    class="bg-indigo-600 text-white px-6 py-3 rounded-lg shadow hover:bg-indigo-700">
    üìç On-Going Class
  </button>
</div>

<div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
  <div class="bg-white p-4 rounded-lg shadow text-center">
    <h3 class="font-semibold mb-1">Current Class</h3>
    <p id="current-class-info" class="text-gray-700">No class currently.</p>
  </div>
  <div class="bg-white p-4 rounded-lg shadow text-center">
    <h3 class="font-semibold mb-1">Next Class</h3>
    <p id="next-class-info" class="text-gray-700">No upcoming class.</p>
  </div>
</div>

<div class="overflow-x-auto bg-white rounded-lg shadow">
<table class="w-full min-w-[700px] text-sm">
<thead class="bg-gray-100 border-b">
<tr>
<th class="px-4 py-3 w-1/6">Time</th>
<th class="px-4 py-3 text-center">Monday</th>
<th class="px-4 py-3 text-center">Tuesday</th>
<th class="px-4 py-3 text-center">Wednesday</th>
<th class="px-4 py-3 text-center">Thursday</th>
<th class="px-4 py-3 text-center">Friday</th>
</tr>
</thead>
<tbody id="timetable-body" class="divide-y"></tbody>
</table>
</div>

<p id="highlight-message"
   class="text-center mt-3 h-5 text-gray-500 transition-opacity"></p>

<footer class="text-center mt-10 text-xs text-gray-500">
Kush Pambhar
</footer>

</div>

<script>
document.addEventListener("DOMContentLoaded",()=>{

// ---------- TIME SLOTS ----------
const timeSlots=["8","9","10","11","12","13","14","15","16"];
function formatTime(h){
return ({
8:"08:00 - 08:55 AM",
9:"09:00 - 09:55 AM",
10:"10:00 - 10:55 AM",
11:"11:00 - 11:55 AM",
12:"12:00 - 12:55 PM",
13:"01:00 - 01:55 PM",
14:"02:00 - 02:55 PM",
15:"03:00 - 03:55 PM",
16:"04:00 - 04:55 PM"
})[h];
}

const days=["mon","tue","wed","thu","fri"];
const dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
const dayToIndex={mon:0,tue:1,wed:2,thu:3,fri:4};
const indexToDay=["mon","tue","wed","thu","fri"];

// ---------- COMMON THEORY (ALL SECTIONS) ----------
const common={

mon:{
"9":{subject:"22EET291 ‚Äî Control Systems",location:"VLTC-L208"},
"10":{subject:"22ECT251 ‚Äî Analog CMOS IC",location:"VLTC-L208"},
"11":{subject:"22ECT253 ‚Äî Digital Communication",location:"VLTC-L208"},
"12":{subject:"22ECT255 ‚Äî Microwave Engineering",location:"VLTC-L208"}
},

// Tuesday theory shift (per your rule)
tue:{
"9":{subject:"22EET291 ‚Äî Control Systems",location:"VLTC-L208"},
// "10" intentionally empty
"11":{subject:"22ECT253 ‚Äî Digital Communication",location:"VLTC-L208"}, // shifted from 10
"12":{subject:"22ECT255 ‚Äî Microwave Engineering",location:"VLTC-L208"}, // shifted from 11

},

wed:{
"9":{subject:"22EET291 ‚Äî Control Systems",location:"VLTC-L208"},
"10":{subject:"22ECT252 ‚Äî Computer Architecture",location:"VLTC-L208"},
"11":{subject:"22ECT251 ‚Äî Analog CMOS IC",location:"VLTC-L208"},
"12":{subject:"22ECT254 ‚Äî Digital Signal Processing",location:"VLTC-L208"}
},

thu:{
"9":{subject:"22ECT252 ‚Äî Computer Architecture",location:"VLTC-L208"},
"10":{subject:"22ECT256 ‚Äî Technical Documentation",location:"VLTC-L208"},
"11":{subject:"22ECT253 ‚Äî Digital Communication",location:"VLTC-L208"},
"12":{subject:"22ECT254 ‚Äî Digital Signal Processing",location:"VLTC-L208"}
},

fri:{
"9":{subject:"22ECT255 ‚Äî Microwave Engineering",location:"VLTC-L208"},
"10":{subject:"22ECT252 ‚Äî Computer Architecture",location:"VLTC-L208"},
"11":{subject:"22ECT251 ‚Äî Analog CMOS IC",location:"VLTC-L208"},
"12":{subject:"22ECT254 ‚Äî Digital Signal Processing",location:"VLTC-L208"}
}
};

// ---------- LAB RULE ENGINE ----------

// Base rotation (ECE-1)
const baseECE1Labs={
mon:{subject:"Analog CMOS Lab",location:"ACSL"},
tue:{subject:"Digital Communication Lab",location:"Computing Lab"},
wed:{subject:"Microwave Engineering Lab",location:"Antenna Lab"},
thu:{subject:"DSP Lab",location:"Computing Lab"}
// fri = no lab
};

// No-lab days
const noLabDays={
ece1:["fri"],
ece2:["mon"],
ece3:["tue"],
ece4:["wed"],
ece5:["thu"]
};

// Circular shift offsets
const sectionOffset={
ece1:0,
ece2:1,
ece3:2,
ece4:3,
ece5:4
};

// Generate labs based on rules
function generateSectionLabs(sectionKey){
 const labs={};
 const offset=sectionOffset[sectionKey];
 const skip=noLabDays[sectionKey]||[];

 for(const day of days){

   if(skip.includes(day)) continue;

   const idx=dayToIndex[day];
   const baseIndex=(idx-offset+5)%5;
   const baseDay=indexToDay[baseIndex];
   const lab=baseECE1Labs[baseDay];

   if(!lab) continue;

   if(!labs[day]) labs[day]={};

   // Same lab for full 2‚Äì4 block
   labs[day]["14"]={subject:lab.subject,location:`${lab.location} (2 hrs)`};
   labs[day]["15"]={subject:lab.subject,location:`${lab.location} (2 hrs)`};
 }

 return labs;
}

// ---------- THEORY-FIRST DEEP MERGE ----------
function mergeSchedules(common, sectionLabs){
 const result = JSON.parse(JSON.stringify(common)); // keep theory intact

 for(const day in sectionLabs){
   if(!result[day]) result[day]={};

   for(const slot in sectionLabs[day]){
     result[day][slot]=sectionLabs[day][slot]; // override only that slot
   }
 }

 return result;
}

// ---------- DOM ----------
const timetableBody=document.getElementById("timetable-body");
const eceSelector=document.getElementById("ece-selector");
const highlightButton=document.getElementById("highlight-now-btn");
const messageEl=document.getElementById("highlight-message");
const currentClassInfoEl=document.getElementById("current-class-info");
const nextClassInfoEl=document.getElementById("next-class-info");

// Compute initial schedule
let currentSchedule = mergeSchedules(common, generateSectionLabs(eceSelector.value));

// ---------- RENDER ----------
function renderTimetable(schedule){
timetableBody.innerHTML="";
timeSlots.forEach(time=>{
 const row=document.createElement("tr");

 const timeCell=document.createElement("th");
 timeCell.className="px-4 py-4 bg-gray-50 font-medium";
 timeCell.textContent=formatTime(time);
 row.appendChild(timeCell);

 days.forEach(day=>{
  const cell=document.createElement("td");
  cell.id=`${day}-${time}`;
  cell.className="px-2 py-2 border-l";

  const wrap=document.createElement("div");
  wrap.className="timetable-cell-content";

  const s=schedule[day]?.[time];
  if(s){
    const sub=document.createElement("span");
    sub.className="subject";
    sub.textContent=s.subject;
    wrap.appendChild(sub);

    if(s.location){
      const loc=document.createElement("span");
      loc.className="location";
      loc.textContent=s.location;
      wrap.appendChild(loc);
    }
  }

  cell.appendChild(wrap);
  row.appendChild(cell);
 });

 timetableBody.appendChild(row);
});
}

// ---------- CURRENT + NEXT ----------
function updateCurrentAndNextClass(){
const now=new Date();
const d=now.getDay();
const h=now.getHours();
const dayStr=["sun","mon","tue","wed","thu","fri","sat"][d];

document.querySelectorAll(".current-slot")
 .forEach(c=>c.classList.remove("current-slot"));

let cur="No class currently.";
let nxt="No upcoming class.";

if(days.includes(dayStr)){
 const today=currentSchedule[dayStr];

 if(today?.[h]){
  cur=`${today[h].subject} (${today[h].location||"N/A"})`;
  const cell=document.getElementById(`${dayStr}-${h}`);
  if(cell) cell.classList.add("current-slot");
 }

 for(const t of timeSlots){
  const H=parseInt(t,10);
  if(H>h && today?.[H]){
   nxt=`${today[H].subject} (${today[H].location||"N/A"}) at ${formatTime(H)}`;
   break;
  }
 }
}

currentClassInfoEl.textContent=cur;
nextClassInfoEl.textContent=nxt;
}

// ---------- INIT ----------
renderTimetable(currentSchedule);
updateCurrentAndNextClass();

// On section change
eceSelector.addEventListener("change",e=>{
 const labs=generateSectionLabs(e.target.value);
 currentSchedule=mergeSchedules(common,labs); // THEORY FIRST ‚úî
 renderTimetable(currentSchedule);
 updateCurrentAndNextClass();
});

// Button highlight
highlightButton.addEventListener("click",()=>{
 updateCurrentAndNextClass();
 messageEl.textContent="Highlighted current slot";
 messageEl.style.opacity="1";
 setTimeout(()=>messageEl.style.opacity="0",2000);
});

setInterval(updateCurrentAndNextClass,60000);
});
</script>

</body>
